createClient:
  handler: src/clients/handler/create-client.handler
  name: gerCutraro-dev-createClient
  timeout: 10
  environment:
    SNS_ARN: !Ref ClientCreatedNotification
  iamRoleStatementsName: gerCutraro-createClient-dev
  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - dynamodb:PutItem
      Resource: !GetAtt clientsTable.Arn
    - Effect: 'Allow'
      Action:
        - sns:Publish
      Resource: !Ref ClientCreatedNotification
  events:
    - http:
        path: 'clients'
        method: post
        cors: true

getAllClients:
  handler: src/clients/handler/get-all-clients.handler
  name: gerCutraro-dev-getAllClients
  timeout: 10
  iamRoleStatementsName: gerCutraro-getAllClients-dev
  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - dynamodb:Scan
      Resource: !GetAtt clientsTable.Arn
  events:
    - http:
        path: 'clients'
        method: get
        cors: true

getOneClient:
  handler: src/clients/handler/get-one-client.handler
  name: gerCutraro-dev-getOneClient
  description: Get client by id
  timeout: 10
  iamRoleStatementsName: gerCutraro-getOneClient-dev
  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - dynamodb:Scan
      Resource: [!GetAtt clientsTable.Arn, !Join ['/', [!GetAtt clientsTable.Arn, index/*]]]
  events:
    - http:
        path: 'clients/{id}'
        method: get
        cors: true

deleteClient:
  handler: src/clients/handler/delete-client.handler
  name: gerCutraro-dev-deleteClient
  description: Delete client by id
  timeout: 10
  iamRoleStatementsName: gerCutraro-deleteClient-dev
  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - dynamodb:Scan
        - dynamodb:UpdateItem
      Resource: !GetAtt clientsTable.Arn
  events:
    - http:
        path: 'clients'
        method: delete
        cors: true
